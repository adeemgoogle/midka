// Tests/WrapperMock.cs
public class WrapperMock : Wrapper
{
    public WrapperMock(Wrapper originalWrapper)
    {
        _originalWrapper = originalWrapper;
    }

    private Wrapper _originalWrapper;

    public virtual bool IsConnected => _originalWrapper.IsConnected;

    // Перенаправляем все остальные методы к исходному Wrapper
    // ... 
}



[Test]
public void ReadOrders_WhenNotReading_StartsReadingAndReturnsOK()
{
    // Arrange
    _server.isReadingTable["ORDERS"] = false;
    
    // Создаем обертку вокруг Wrapper и настраиваем IsConnected
    var wrapperMock = new WrapperMock(_server.AstsServer);
    Mock.Get(wrapperMock).Setup(w => w.IsConnected).Returns(true);

    // "Подменяем" AstsServer на обертку
    _server.AstsServer = wrapperMock; 

    // Act
    var result = _server.ReadOrders();

    // Assert
    Assert.AreEqual("OK", result);
    Assert.IsTrue(_server.isReadingTable["ORDERS"]);
}
