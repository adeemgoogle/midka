 public unsafe void GetSecurity(string[] Boards, string KafkaTopic, bool isDailyReport)
 {
     int tableDescriptor;
     UniversalTable table;
     int sdvig;
     
     string par;
     SecurityTable res = new SecurityTable("", 0);
     res.Rows = new List<SecurityRow>();

     foreach (string board in Boards){
         par = "    " + board;

         table = OpenTableNonString("SECURITIES", par, out tableDescriptor);
         if (table.Rows.Count == 0){
             continue;
         }

         
         if (isDailyReport)
         {
             var securitiesFromUniversalTable = SecurityTable.ParseDailySecuritiesFromUniversalTable(table);
             foreach (var row in securitiesFromUniversalTable.RowsDictionary)
             {
                
                 if (row.Value.secName == "KZTO") 
                 {
                     res.Rows.Add(row.Value);
                 }
                 if (row.Value.secName == "KZTK")
                 {
                     res.Rows.Add(row.Value);
                 }
                 if (row.Value.secName == "KMGZ")
                 {
                     res.Rows.Add(row.Value);
                 }
                 if (row.Value.secName == "KEGC")
                 {
                     res.Rows.Add(row.Value);
                 }
                 if (row.Value.secName == "CCBN")
                 {
                     res.Rows.Add(row.Value);
                 }
                 
             }
            
         }
 if (res.Rows.Count > 1)
 {
     var key = "SECURITIES";
     var jsonStr = JsonConvert.SerializeObject(res.Rows);
     if (isDailyReport)
     {
         var jArray = JArray.Parse(jsonStr);
         foreach (var item in jArray)
         {
             _kafka.Write(KafkaTopic, key, item.ToString());
         }
     }


как сделать запись в кафку 1 json = 1 сообщение в кафке.
помоги доработать if 
