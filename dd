using System;
using System.Text;

Encoding.RegisterProvider(CodePagesEncodingProvider.Instance);

string secnameEncoded = row.GetAsString("SECNAME");
if (secnameEncoded != null)
{
    // Выводим исходную строку для проверки
    Console.WriteLine("Исходная строка: " + secnameEncoded);

    // Пробуем различные кодировки
    string[] encodings = { "windows-1251", "utf-8", "iso-8859-1", "koi8-r" };
    foreach (string encodingName in encodings)
    {
        try
        {
            Encoding encoding = Encoding.GetEncoding(encodingName);
            byte[] bytes = Encoding.Default.GetBytes(secnameEncoded);
            string decodedString = encoding.GetString(bytes);
            Console.WriteLine($"Декодированная строка с кодировкой {encodingName}: {decodedString}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Ошибка при использовании кодировки {encodingName}: {ex.Message}");
        }
    }
}
