package go_bonus

import (
    "log"
    "testing"
    "time"

    "github.com/your/package/internal/models"
    "github.com/your/package/pkg/config"
    "github.com/stretchr/testify/assert"
    "github.com/stretchr/testify/mock"
)

type MockMarksLogger interface {
    LogStudentMarks(marks []*models.StudentMark, markLoadDateString string, bonus *models.Bonus) error
}

type MockBonusRedeemer struct {
    marksLogger MockMarksLogger
}

func (m *MockBonusRedeemer) LogStudentMarks(marks []*models.StudentMark, markLoadDateString string, bonus *models.Bonus) error {
    return nil
}

func TestRedeemBonus(t *testing.T) {
    // Создаем мок-объект MarksLogger
    mockLogger := &MockMarksLogger{}

    s := &BonusRedeemer{
        marksLogger: mockLogger,
    }
    // Не нужно вызывать config.Parse() в тесте

    student := &models.StudentWithMarks{
        Marks: []*models.StudentMark{
            {
                KundelikID:     "1000003352507",
                MarkDateString: "2024-02-07 08:58:23.000000",
                SubjectID:      "1208089952166536233",
                GroupParallel:  6,
            },
        },
        Student: models.Student{
            KundelikID: "1000003352507",
            OwClientID: "288154590",
            CreatedAt:  time.Date(2024, time.February, 9, 14, 19, 7, 560389, time.UTC),
        },
    }

    err := s.RedeemBonus(student)
    assert.NoError(t, err)
}

type MockSaramaProducer struct {
    mock.Mock
}

func (m *MockSaramaProducer) SendMessage(msg *sarama.ProducerMessage) (partition int32, offset int64, err error) {
    args := m.Called(msg)
    return args.Get(0).(int32), args.Get(1).(int64), args.Error(2)
}

func TestSendMessage(t *testing.T) {
    // Создаем мок-объект SaramaProducer
    mockProducer := &MockSaramaProducer{}

    // Используем мок-объект вместо реального producer

    // Здесь создание нового сообщения msg

    _, _, err := mockProducer.SendMessage(msg)
    assert.NoError(t, err)
}

это мой тест
package go_bonus

import (
	"github.com/stretchr/testify/require"
	_ "github.com/stretchr/testify/require"
	"mark-worker/internal/models"
	"mark-worker/pkg/config"
	"testing"
	"time"
)

type MockMarksLogger interface {
	LogStudentMarks(marks []*models.StudentMark, markLoadDateString string, bonus *models.Bonus) error
}

type MockBonusRedeemer struct {
	marksLogger MarksLogger
}

func (m MockBonusRedeemer) LogStudentMarks(marks []*models.StudentMark, markLoadDateString string, bonus *models.Bonus) error {
	return nil
}

func TestRedeemBonus(t *testing.T) {
	s := &BonusRedeemer{
		marksLogger: &MockBonusRedeemer{},
	}
	config.Parse()

	student := models.StudentWithMarks{
		Marks: []*models.StudentMark{
			{
				KundelikID:     "1000003352507",
				MarkDateString: "2024-02-07 08:58:23.000000",
				SubjectID:      "1208089952166536233",
				GroupParallel:  6,
			},
		},
		Student: models.Student{
			KundelikID: "1000003352507",
			OwClientID: "288154590",
			CreatedAt:  time.Date(2024, time.February, 9, 14, 19, 7, 560389, time.UTC),
		},
	}

	err := s.RedeemBonus(&student)
	require.NoError(t, err)
}

это моя функция
func SendMessage(topic string, message []byte) (int32, int64, error) {
	newMessage := &sarama.ProducerMessage{
		Topic: topic,
		Value: sarama.ByteEncoder(message),
	}

	partition, offset, err := producer.SendMessage(newMessage)
	if err != nil {
		log.Println("failed to send message to kafka", "error", err)
		return 0, 0, err
	}

	return partition, offset, nil
}

это мне надо замокать

_, _, err = broker.SendMessage(config.Get().KafkaTopic, msg)
